import onReady from"./modules/onReady.js";import sleep from"./modules/sleep.js";import backToTop from"./modules/backToTop.js";import checkLogin from"./modules/checkLogin.js";import handleLogout from"./modules/handleLogout.js";import makeApiCall from"./modules/makeApiCall.js";import renderPinnedPosts from"./modules/renderPinnedPosts.js";onReady((async()=>{checkLogin(),handleLogout(),backToTop();let e=localStorage.getItem("user_id");if(!e){const n=await makeApiCall("/api/v1/accounts/verify_credentials");n.id&&(localStorage.setItem("user_id",n.id),e=n.id)}if(e){const n=await makeApiCall(`/api/v1/accounts/${e}/statuses?limit=80&pinned=true`);if(n&&0!==n.length){renderPinnedPosts(n);const e=".list-group",o=document.getElementById("save-pinned-posts");new Sortable.default([...document.getElementsByClassName("list-group")],{draggable:"li",mirror:{appendTo:e,constrainDimensions:!0}});o.addEventListener("click",(async e=>{let n=[...document.querySelectorAll("#pinned-posts li")].map((e=>e.dataset.id));o.disabled=!0,o.innerHTML="Unpinning posts...";for(const e of n){console.log("unpinning...",e);await makeApiCall(`api/v1/statuses/${e}/unpin`,"POST");await sleep(500)}o.innerHTML="Pinning posts...",n=n.reverse();for(const e of n){console.log("pinning...",e);await makeApiCall(`api/v1/statuses/${e}/pin`,"POST");await sleep(500)}o.innerHTML="Done!",await sleep(700),o.disabled=!1,o.innerHTML="Save pinned posts"}))}else document.getElementsByClassName("container")[1].innerHTML='\n      <p>\n        Could not load your pinned posts. Please make sure you\'re logging into a Mastodon server, or try again later. \n      </p>\n      <p>\n        <a href="https://stefanbohacek.com/contact/">Get in touch</a>\n      </p>\n      '}}));//# sourceMappingURL=app.js.map
